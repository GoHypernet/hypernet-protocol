(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{176:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return l})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return u}));var a=n(2),r=n(6),o=(n(0),n(420)),i=n(432),l={id:"quick-start-dapp",title:"Quick start (Dapp)"},c={unversionedId:"app-devs/quick-start-dapp",id:"app-devs/quick-start-dapp",isDocsHomePage:!1,title:"Quick start (Dapp)",description:"By using our reference state channels wallet implementation, you will be able to rapidly develop a statechannels-powered Dapp that does not need to manage keys, interface with an ethereum provider or understand nitro-protocol at all. Instead, it only needs to target our channel-client API.",source:"@site/docs/app-devs/quick-start-dapp.md",permalink:"/app-devs/quick-start-dapp",lastUpdatedBy:"Caleb Ditchfield",lastUpdatedAt:1600126133,sidebar:"docs",previous:{title:"Quick start (contracts)",permalink:"/app-devs/quick-start-contracts"},next:{title:"Hook up your messaging layer",permalink:"/app-devs/hook-up-messaging"}},s=[{value:"Installing",id:"installing",children:[]},{value:"Enabling the channel provider",id:"enabling-the-channel-provider",children:[]},{value:"App &lt;-&gt; Wallet security",id:"app---wallet-security",children:[]}],p={rightToc:s};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},p,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"By using our reference state channels wallet implementation, you will be able to rapidly develop a statechannels-powered Dapp that does not need to manage keys, interface with an ethereum provider or understand nitro-protocol at all. Instead, it only needs to target our channel-client API."),Object(o.b)("h2",{id:"installing"},"Installing"),Object(o.b)("p",null,"You will want to add both ",Object(o.b)("inlineCode",{parentName:"p"},"@statechannels/channel-client")," and ",Object(o.b)("inlineCode",{parentName:"p"},"@statechannels/iframe-channel-provider")," to your project:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-console"}),"> yarn add @statechannels/channel-client @statechannels/iframe-channel-provider\n")),Object(o.b)("p",null,"Think about the client as exposing a friendly API for your Dapp, and the provider as a lower level bit of plumbing that it uses to connect to our wallet."),Object(o.b)("p",null,"The wallet code will be downloaded by the browser and executed inside an iFrame. The channel-provider uses ",Object(o.b)("inlineCode",{parentName:"p"},"postMessage")," under the hood to communicate with the wallet. Set it up as follows:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"// Attaches the channel provider to the window object\nrequire('@statechannels/iframe-channel-provider');\n")),Object(o.b)("h2",{id:"enabling-the-channel-provider"},"Enabling the channel provider"),Object(o.b)("p",null,"The channel provider needs to be pointed at our hosted wallet:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"await window.channelProvider.mountWalletComponent('https://xstate-wallet.statechannels.org/');\n")),Object(o.b)("p",null,"This step mounts the wallet iFrame in your Dapp, configures communication and performs an initial handshake with the wallet."),Object(o.b)("p",null,"At some point in your user flow, you will want to enable the wallet:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-typescript"}),"await window.channelProvider.enable();\n")),Object(o.b)("p",null,"If everything is setup correctly, you should see the statechannels wallet UI:"),Object(o.b)("p",{align:"center"},Object(o.b)("img",{alt:"Wallet UI",src:Object(i.a)("img/wallet-ui.png"),className:"drop-shadow"})),Object(o.b)("p",null,"Because this popup will be triggered, to maintain a good UX you should only call ",Object(o.b)("inlineCode",{parentName:"p"},"window.channelProvider.enable()")," when the user clicks a button."),Object(o.b)("h2",{id:"app---wallet-security"},"App <-> Wallet security"),Object(o.b)("p",null,"Having the wallet served in an iFrame from a different domain to the app is an important component from a security standpoint. The app can only send and receive messages to the wallet, and cannot otherwise access its code or storage. Furthermore, it means the app <-> wallet communication is cross-origin, and the wallet can associate policies (such as whitelists) and other data (such as channels and keys) to each domain."),Object(o.b)("p",null,"Ethereum wallets will typically prompt the user, when triggered by an application, to approve access to the accounts it controls for the domain that application is served from. Wallets should not implicitly trust applications or grant them access to sign away assets, because unknown applications could contain malicious code and put those asssets at risk."),Object(o.b)("p",null,"The same is true for our wallet: when the ",Object(o.b)("inlineCode",{parentName:"p"},".enable()")," call is made, the user is asked for approval (see above)."),Object(o.b)("p",null,"There are a few differences between a state channel wallet and an Ethereum wallet, which are important to understand."),Object(o.b)("p",null,'Because state channel applications are capable of very rapid throughput of state updates (or "Layer 2 transactions"), it would not be feasible to ask for user approval for each one. It is for this reason that our wallet will create an "ephemeral key" to sign state updates (sliently), instead of using your Ethereum key.'),Object(o.b)("div",{className:"admonition admonition-important alert alert--info"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"important")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"This ephemeral key is only used for creating signatures that will be recovered in our adjudicator contract, and isn't designed to ",Object(o.b)("em",{parentName:"p"},"directly")," control any on chain funds. When it comes to releasing assets on chain, however, the money still goes to your Ethereum account when your state channel closes."))),Object(o.b)("p",null,'Our wallet uses the concept of a "Domain Budget" to further reduce the amount of user interaction that is required. The budget can be ',Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"../typescript-api/channel-client.channelclient.approvebudgetandfund"}),"approved"),' on the user\'s first visit to an application, and specifies a maximum send and maximum receive amount for each asset type (e.g. ETH). It then only needs to be administered or "topped-up" when the maximum amounts are reached. Otherwise, the wallet will not prompt the user at all when creating and closing channels, but will silently perform the necessary steps to do so. You can see budgets in action by trying out our ',Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://web3torrent.statechannels.org/"}),"Web3Torrent")," app."))}u.isMDXComponent=!0},420:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h}));var a=n(0),r=n.n(a);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),p=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},b=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),u=p(n),b=a,h=u["".concat(i,".").concat(b)]||u[b]||d[b]||o;return n?r.a.createElement(h,l(l({ref:t},s),{},{components:n})):r.a.createElement(h,l({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=b;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},422:function(e,t,n){"use strict";var a=n(0),r=n(22);t.a=function(){var e=Object(a.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},432:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var a=n(422),r=n(450);function o(){var e=Object(a.a)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,n=void 0===t?"/":t,o=e.url;return{withBaseUrl:function(e,t){return function(e,t,n,a){var o=void 0===a?{}:a,i=o.forcePrependBaseUrl,l=void 0!==i&&i,c=o.absolute,s=void 0!==c&&c;if(!n)return n;if(n.startsWith("#"))return n;if(Object(r.b)(n))return n;if(l)return t+n;var p=!n.startsWith(t)?t+n.replace(/^\//,""):n;return s?e+p:p}(o,n,e,t)}}}function i(e,t){return void 0===t&&(t={}),(0,o().withBaseUrl)(e,t)}},450:function(e,t,n){"use strict";function a(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!a(e)}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}))}}]);